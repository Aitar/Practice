import sys

def copyBooks(pages, k):
    """
    LS：前 i 本书由 k 个人抄完最少用时 x 分钟
        假设第 k 个人超 a 本书用时 y 分钟
    SQ：那么前 i-a 本书由 k-1 个人抄完用时 z 分钟，x = max{z，y}
    MF：f(i, j) := 前 i 本书由 j 个人抄完的时间
                                         k
        f(i, j) = min{ max{ f(i-k, j-1), ∑ pages(q) } }
                    1 <= k <= i-j+1     q=1
    B：f(i, j) = 0 when i == 0 or j == 0
    https://www.lintcode.com/problem/437/
    @param pages: an array of integers
    @param k: An integer
    @return: an integer
    """
    if len(pages) <= k:
        return max(pages)

    dp = [[0 for _ in range(k + 1)] for _ in range(len(pages) + 1)]

    for i in range(1, len(dp)):
        for j in range(0, len(dp[i])):
            if j == 0:
                dp[i][j] = sys.maxsize
                continue
            if j <= i:
                sum = 0
                dp[i][j] = sys.maxsize
                for q in range(0, i - j + 1):
                    sum += pages[i - q - 1]
                    dp[i][j] = min(max(dp[i - q - 1][j - 1], sum), dp[i][j])

    return dp[len(pages)][k]

if __name__ == '__main__':
    a = [8720, 1593, 4278, 1018, 9515, 5536, 8694, 869, 8423, 9920, 3425, 9689, 9908, 1404, 8371, 6019, 7531, 943, 9280,
     8058, 1445, 7485, 9223, 5067, 736, 6065, 1724, 3269, 130, 1297, 1701, 5585, 1209, 5901, 3760, 3216, 5307, 8534,
     9575, 7135, 1251, 3531, 5162, 7432, 8559, 2024, 9738, 2621, 7926, 3865, 9904, 4763, 2031, 4561, 5870, 6033, 6442,
     6405, 9886, 8455, 8970, 6746, 7923, 5222, 274, 3875, 5821, 816, 3459, 9916, 9447, 4252, 1871, 5784, 8272, 9526,
     1531, 5647, 6676, 2416, 6281, 7878, 4382, 5376, 3618, 1158, 3717, 5573, 5602, 5919, 7579, 6628, 929, 6897, 8324,
     8657, 8342, 8190, 7384, 2466, 8715, 2499, 9144, 7349, 3236, 2852, 4613, 1917, 5345, 9288, 9205, 3363, 5008, 156,
     4716, 6924, 3490, 605, 3872, 577, 5393, 7941, 7390, 7042, 8242, 5376, 5939, 3910, 4727, 4053, 4850, 5531, 2658,
     3876, 9379, 6157, 7544, 2845, 5499, 459, 3119, 2984, 5567, 5706, 1507, 5971, 8369, 8177, 5985, 1215, 8258, 2925,
     9193, 7999, 334, 4761, 2586, 7770, 195, 5804, 3898, 7214, 6625, 2975, 4078, 5441, 9944, 4161, 9225, 7012, 6383,
     4441, 4474, 7030, 7292, 6938, 48, 6253, 4707, 2078, 8449, 7011, 65, 7205, 4841, 2066, 5097, 3875, 6431, 2626, 6325,
     789, 5047, 324, 3528, 1325, 2443, 281, 3094, 1908, 9686, 8720, 9310, 6817, 1856, 2137, 7718, 1180, 5988, 8766,
     3408, 8439, 2555, 2214, 2678, 1991, 7393, 6323, 9586, 8430, 3298, 9828, 9386]
    b = 165
    print(copyBooks(a, b))
